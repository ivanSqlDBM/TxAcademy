name: stg_INVENTORY
color: '#FC7917'
isSource: false
columns:
  - name: PART_ID
    allowNulls: false
    dataType: NUMBER(38,0)
    defaultValue: ''
    description: part of unique identifier with ps_suppkey
    useQuotes: false
    id: dfe47b79-ef45-48ba-a46d-04a4096b85c1
    isPK: true
  - name: SUPPLIER_ID
    allowNulls: false
    dataType: NUMBER(38,0)
    defaultValue: ''
    description: part of unique identifier with ps_partkey
    useQuotes: false
    id: 396d4f7a-409f-4de1-989a-b901514f6723
    isPK: true
  - name: AVAILABLE_AMOUNT
    allowNulls: false
    dataType: NUMBER(38,0)
    defaultValue: ''
    description: number of parts available for sale
    useQuotes: false
    id: 897087cb-59bc-473f-9b91-bf72a0bbc001
  - name: SUPPLIER_COST_USD
    allowNulls: false
    dataType: NUMBER(12,2)
    defaultValue: ''
    description: original cost paid to supplier
    useQuotes: false
    id: 01a9d208-a685-428b-a861-7afa83289ba6
  - name: COMMENT
    allowNulls: true
    dataType: VARCHAR(16777216)
    defaultValue: ''
    description: ''
    useQuotes: false
    id: 24741084-2f33-410c-be7c-b1a56ee06802
  - name: __LOAD_DTS
    allowNulls: true
    dataType: TIMESTAMP_LTZ(9)
    defaultValue: ''
    description: ''
    useQuotes: false
    id: 95e62f72-46a6-4d07-b227-597708f06667
logic: |-
  with INVENTORY as (
      SELECT
          PART_ID,
          SUPPLIER_ID,
          AVAILABLE_AMOUNT,
          SUPPLIER_COST_USD,
          COMMENT,
          __LOAD_DTS
      FROM {{ref('RAW', 'INVENTORY')}}
  )
  ,
  common as (
      SELECT
          INVENTORY.PART_ID,
          INVENTORY.SUPPLIER_ID,
          INVENTORY.AVAILABLE_AMOUNT,
          INVENTORY.SUPPLIER_COST_USD,
          INVENTORY.COMMENT,
          INVENTORY.__LOAD_DTS
      FROM INVENTORY
  )

  SELECT * FROM common
description: ''
logicalName: stage INVENTORY
columnSets:
  - itemName: PK
    setName: PK_stg_INVENTORY
    columns:
      - columnId: dfe47b79-ef45-48ba-a46d-04a4096b85c1
        position: 1
        name: PART_ID
        useQuotes: false
      - columnId: 396d4f7a-409f-4de1-989a-b901514f6723
        position: 2
        name: SUPPLIER_ID
        useQuotes: false
    id: 708425e0-db17-4ca0-8c75-e8f5e417bcb5
useQuotes: false
templateId: f0b6697a-7eb4-4925-9f72-ec5eb6318733
materialization: table
storageLocationId: f444de18-2d02-4df6-9c54-36ca0a2c7e40
truncateBefore: false
preCreate:
  value:
    - ''
  isValidated: false
postCreate:
  value:
    - ''
  isValidated: false
preRun:
  value:
    - ''
  isValidated: false
postRun:
  value:
    - ''
  isValidated: false
rely_button: true
id: 3bda313a-a5ee-4ed6-82e1-033fb918045c
nodeFormat: dynamic
references:
  4b65bbbe-37e2-473e-a3dc-deb8154f4661:
    parentTableId: 05482f6b-5f10-4b87-b611-bf986c50636a
    id: 4b65bbbe-37e2-473e-a3dc-deb8154f4661
