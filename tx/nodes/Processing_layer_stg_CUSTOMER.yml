name: stg_CUSTOMER
id: 486ad7e9-9059-4ce6-a25e-4c011acc83f8
storageLocationId: f444de18-2d02-4df6-9c54-36ca0a2c7e40
templateId: f0b6697a-7eb4-4925-9f72-ec5eb6318733
materialization: table
isSource: false
columns:
  - name: CUSTOMER_ID
    dataType: number(38,0)
    allowNulls: false
    defaultValue: ''
    description: ''
    id: 1c7ebeb1-355e-453b-ad6f-038926c34c59
    isPK: true
  - name: NAME
    dataType: varchar(16777216)
    allowNulls: false
    defaultValue: ''
    description: ''
    id: c5a93ac8-3d45-4b36-b1f7-11ab0364e760
  - name: ADDRESS
    dataType: varchar(16777216)
    allowNulls: false
    defaultValue: ''
    description: ''
    id: d52b485c-05cc-4414-9daf-18c34005cecc
  - name: LOCATION_ID
    dataType: number(38,0)
    allowNulls: false
    defaultValue: ''
    description: ''
    id: 81178017-a9c4-466e-8141-b3f2e1cebbd8
  - name: PHONE
    dataType: varchar(15)
    allowNulls: false
    defaultValue: ''
    description: ''
    id: 8501ec1a-c107-4455-9c9c-52646f6ce078
  - name: ACCOUNT_BALANCE_USD
    dataType: number(12,2)
    allowNulls: false
    defaultValue: ''
    description: ''
    id: 965ce838-5ff3-430e-8a57-a9fdf9625705
  - name: MARKET_SEGMENT
    dataType: varchar(10)
    allowNulls: false
    defaultValue: ''
    description: ''
    id: bbcd9adc-1e25-4bd4-ae49-856759de2e0e
  - name: COMMENT
    dataType: varchar(16777216)
    allowNulls: true
    defaultValue: ''
    description: ''
    id: 4d3d5a36-605d-4b2d-8f7d-778702069944
  - name: __LOAD_DTS
    dataType: timestamp_ltz(9)
    allowNulls: true
    defaultValue: ''
    description: ''
    id: 2970d5a0-672e-4535-936f-7384e9bece1c
  - name: __load_date
    dataType: date
    allowNulls: false
    defaultValue: current_date()
    description: load date
    id: 3d69bf86-180e-498b-a280-de180aab4b34
columnSets:
  - id: 8d2463c1-e63d-4ce7-8bbf-f668c2d014f2
    itemName: PK
    setName: PK_stg_CUSTOMER
    columns:
      - columnId: 1c7ebeb1-355e-453b-ad6f-038926c34c59
        position: 1
        name: CUSTOMER_ID
        useQuotes: false
nodeFormat: dynamic
truncateBefore: false
preCreate:
  value:
    - ''
  isValidated: false
postCreate:
  value:
    - ''
  isValidated: false
preRun:
  value:
    - ''
  isValidated: false
postRun:
  value:
    - ''
  isValidated: false
rely_button: true
parentName: Processing_layer
color: '#FC7917'
logic: |-
  with "CUSTOMER" as (
      SELECT
          "CUSTOMER_ID",
          "NAME",
          "ADDRESS",
          "LOCATION_ID",
          "PHONE",
          "ACCOUNT_BALANCE_USD",
          "MARKET_SEGMENT",
          "COMMENT",
          "__LOAD_DTS"
      FROM {{ref('RAW', 'CUSTOMER')}}
  )
  ,
  common as (
      SELECT
          "CUSTOMER"."CUSTOMER_ID",
          "CUSTOMER"."NAME",
          "CUSTOMER"."ADDRESS",
          "CUSTOMER"."LOCATION_ID",
          "CUSTOMER"."PHONE",
          "CUSTOMER"."ACCOUNT_BALANCE_USD",
          "CUSTOMER"."MARKET_SEGMENT",
          "CUSTOMER"."COMMENT",
          "CUSTOMER"."__LOAD_DTS",
          current_date() AS "__load_date"
      FROM "CUSTOMER"
  )

  SELECT * FROM common
description: ''
logicalName: stage CUSTOMER
references:
  f2e10892-e799-4fc7-a644-8b7c70d6d1d2:
    parentTableId: 39bd16bc-a498-452c-9cba-9defbf84426c
    id: f2e10892-e799-4fc7-a644-8b7c70d6d1d2
